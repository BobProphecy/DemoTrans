from pyspark.sql import *
from pyspark.sql.functions import *
from pyspark.sql.types import *
from prophecy.utils import *
from prophecy.libs import typed_lit
from job.config.ConfigStore import *
from job.udfs.UDFs import *

def TIMST(spark: SparkSession) -> DataFrame:
    return spark.read\
        .schema(
          StructType([
            StructField("TIMST_GRACEINTCMPAMT", IntegerType(), True), StructField("TIMST_MACCTNG2", IntegerType(), True), StructField("TIMST_MOFFICERDES", StringType(), True), StructField("TIMST_RENINTAPPL", IntegerType(), True), StructField("TIMST_RENRENTERM", IntegerType(), True), StructField("TIMST_BACKDATE", StringType(), True), StructField("TIMST_ALERT5", StringType(), True), StructField("TIMST_ALERT3", StringType(), True), StructField("TIMST_ALERT1", StringType(), True), StructField("TIMST_OFFICER2", StringType(), True), StructField("TIMST_OLDEBITS", IntegerType(), True), StructField("TIMST_MCOSTC", IntegerType(), True), StructField("TIMST_RSVSW1", StringType(), True), StructField("TIMST_RSVNBR4", IntegerType(), True), StructField("TIMST_RSVNBR2", IntegerType(), True), StructField("TIMST_RENAPY", IntegerType(), True), StructField("TIMST_RSVDATE2", IntegerType(), True), StructField("TIMST_RSVUSER", StringType(), True), StructField("TIMST_TDOASEQNBR", IntegerType(), True), StructField("TIMST_TDOATERM", StringType(), True), StructField("TIMST_PERDIEM", IntegerType(), True), StructField("TIMST_CUSTSVCAMT", IntegerType(), True), StructField("TIMST_RFEDAMT", IntegerType(), True), StructField("TIMST_RPENALTY", IntegerType(), True), StructField("TIMST_RHOLDS", IntegerType(), True), StructField("TIMST_RCAUTION", StringType(), True), StructField("TIMST_NOTCINT", StringType(), True), StructField("TIMST_NOTCREN", StringType(), True), StructField("TIMST_PNTUSER", StringType(), True), StructField("TIMST_PNTMISC2", StringType(), True), StructField("TIMST_PNTMISC4", StringType(), True), StructField("TIMST_PNTSTMT", StringType(), True), StructField("TIMST_PNTRATE", StringType(), True), StructField("TIMST_PNTTRAN", StringType(), True), StructField("TIMST_MSOCSECREQ1", IntegerType(), True), StructField("TIMST_FEDBDT", IntegerType(), True), StructField("TIMST_FEDTAXHOLD", IntegerType(), True), StructField("TIMST_FEDTAX1099", IntegerType(), True), StructField("TIMST_FEDTAXEXMPT", StringType(), True), StructField("TIMST_RATEDAY", IntegerType(), True), StructField("TIMST_RATEFREQ", StringType(), True), StructField("TIMST_MLSTTRNSEQ", IntegerType(), True), StructField("TIMST_MFBAMT8", IntegerType(), True), StructField("TIMST_MFBAMT6", IntegerType(), True), StructField("TIMST_MFBAMT4", IntegerType(), True), StructField("TIMST_MFBAMT2", IntegerType(), True), StructField("TIMST_MFCAMT9", IntegerType(), True), StructField("TIMST_MFCAMT7", IntegerType(), True), StructField("TIMST_MFCAMT5", IntegerType(), True), StructField("TIMST_MFCAMT3", IntegerType(), True), StructField("TIMST_MFCAMT1", IntegerType(), True), StructField("TIMST_MSIGINDX", IntegerType(), True), StructField("TIMST_MANALYSIS", StringType(), True), StructField("TIMST_MMAP", StringType(), True), StructField("TIMST_MRPT", StringType(), True), StructField("TIMST_MWDAMT", IntegerType(), True), StructField("TIMST_MDEPAMT", IntegerType(), True), StructField("TIMST_MNEWTYPE", IntegerType(), True), StructField("TIMST_MNEWBRANCH", IntegerType(), True), StructField("TIMST_MADES", StringType(), True), StructField("TIMST_MFLAG7", StringType(), True), StructField("TIMST_MFLAG5", StringType(), True), StructField("TIMST_MFLAG3", StringType(), True), StructField("TIMST_MFLAG1", StringType(), True), StructField("TIMST_MBKENTRYREQ", StringType(), True), StructField("TIMST_MLBLREQ", StringType(), True), StructField("TIMST_MSTMREQ", StringType(), True), StructField("TIMST_MPREVACCT", IntegerType(), True), StructField("TIMST_MCONTDT", IntegerType(), True), StructField("TIMST_MACTDT", IntegerType(), True), StructField("TIMST_MDORM", StringType(), True), StructField("TIMST_MSPEC5", StringType(), True), StructField("TIMST_MSPEC3", StringType(), True), StructField("TIMST_MSPEC1", StringType(), True), StructField("TIMST_MCOLLAT", StringType(), True), StructField("TIMST_MTRUST", StringType(), True), StructField("TIMST_MCORRES", StringType(), True), StructField("TIMST_MPRGOVD", StringType(), True), StructField("TIMST_MEMPCD", StringType(), True), StructField("TIMST_MCLASS", StringType(), True), StructField("TIMST_EMPLOYER", IntegerType(), True), StructField("TIMST_IRANUMBER", IntegerType(), True), StructField("TIMST_INTPENRED", IntegerType(), True), StructField("TIMST_INTINDEX", IntegerType(), True), StructField("TIMST_INTPLAN", StringType(), True), StructField("TIMST_INTNOTLDT", IntegerType(), True), StructField("TIMST_INTOID", StringType(), True), StructField("TIMST_INTCMPAMT", IntegerType(), True), StructField("TIMST_INTCMPDAY", IntegerType(), True), StructField("TIMST_INTCMPFREQ", StringType(), True), StructField("TIMST_INTRATEAGR", IntegerType(), True), StructField("TIMST_INTAPPL", IntegerType(), True), StructField("TIMST_INTAGR", IntegerType(), True), StructField("TIMST_INTEQUCD", StringType(), True), StructField("TIMST_INTENP", IntegerType(), True), StructField("TIMST_INTPENYTD", IntegerType(), True), StructField("TIMST_INTYTD", IntegerType(), True), StructField("TIMST_INTMONTH", StringType(), True), StructField("TIMST_INTTENTH", StringType(), True), StructField("TIMST_INTTRANDT", IntegerType(), True), StructField("TIMST_INTMINRATE", IntegerType(), True), StructField("TIMST_INTRATE", IntegerType(), True), StructField("TIMST_INTPAID", IntegerType(), True), StructField("TIMST_INTCMBCK", StringType(), True), StructField("TIMST_INTDAY", IntegerType(), True), StructField("TIMST_INTFREQ", StringType(), True), StructField("TIMST_OID2ENDDT", IntegerType(), True), StructField("TIMST_OID2MOAMT", IntegerType(), True), StructField("TIMST_OID2PAID", IntegerType(), True), StructField("TIMST_OID1RPTD", IntegerType(), True), StructField("TIMST_GRACEINTENP", IntegerType(), True), StructField("TIMST_GRACERATEOPT", StringType(), True), StructField("TIMST_RENINTDISP", StringType(), True), StructField("TIMST_RENINTTERM", IntegerType(), True), StructField("TIMST_RENTYPE", IntegerType(), True), StructField("TIMST_RENUSE", StringType(), True), StructField("TIMST_RENRATE", IntegerType(), True), StructField("TIMST_RENAGR", IntegerType(), True), StructField("TIMST_RENNOTLDT", IntegerType(), True), StructField("TIMST_RENDAY", IntegerType(), True), StructField("TIMST_RENFREQ", StringType(), True), StructField("TIMST_RENNEXT", IntegerType(), True), StructField("TIMST_RENLAST", IntegerType(), True), StructField("TIMST_MATACCT", IntegerType(), True), StructField("TIMST_MATNOTDT", IntegerType(), True), StructField("TIMST_MATDISP", StringType(), True), StructField("TIMST_SCAGRCOL", IntegerType(), True), StructField("TIMST_SCPREVLOW", IntegerType(), True), StructField("TIMST_SCITEMS", IntegerType(), True), StructField("TIMST_SCCRNBR", IntegerType(), True), StructField("TIMST_SCAPPL", IntegerType(), True), StructField("TIMST_SCPARM", IntegerType(), True), StructField("TIMST_SCHCD12", StringType(), True), StructField("TIMST_SCHCD11", StringType(), True), StructField("TIMST_SCHCD10", StringType(), True), StructField("TIMST_SCHCD09", StringType(), True), StructField("TIMST_SCHCD08", StringType(), True), StructField("TIMST_SCHCD07", StringType(), True), StructField("TIMST_SCHCD06", StringType(), True), StructField("TIMST_SCHCD05", StringType(), True), StructField("TIMST_SCHCD04", StringType(), True), StructField("TIMST_SCHCD03", StringType(), True), StructField("TIMST_SCHCD02", StringType(), True), StructField("TIMST_SCHCD01", StringType(), True), StructField("TIMST_SCDAY4", IntegerType(), True), StructField("TIMST_SCDAY2", IntegerType(), True), StructField("TIMST_SCTERM", IntegerType(), True), StructField("TIMST_SCDTNXT", IntegerType(), True), StructField("TIMST_STMRATEAGR", IntegerType(), True), StructField("TIMST_STMACCT", IntegerType(), True), StructField("TIMST_STMCODAY4", IntegerType(), True), StructField("TIMST_STMCODAY2", IntegerType(), True), StructField("TIMST_STMCOTERM", IntegerType(), True), StructField("TIMST_STMCOBAL", IntegerType(), True), StructField("TIMST_STMDISP", StringType(), True), StructField("TIMST_STMNOACT", StringType(), True), StructField("TIMST_STMSORT", StringType(), True), StructField("TIMST_STMDRAMT", IntegerType(), True), StructField("TIMST_PBBAL", IntegerType(), True), StructField("TIMST_PBUNRINT", IntegerType(), True), StructField("TIMST_PBNBKCRAMT", IntegerType(), True), StructField("TIMST_PBFLAG", StringType(), True), StructField("TIMST_ODY11", IntegerType(), True), StructField("TIMST_ODY09", IntegerType(), True), StructField("TIMST_ODY07", IntegerType(), True), StructField("TIMST_ODY05", IntegerType(), True), StructField("TIMST_ODY03", IntegerType(), True), StructField("TIMST_ODY01", IntegerType(), True), StructField("TIMST_ODDATE", IntegerType(), True), StructField("TIMST_BALCA11", IntegerType(), True), StructField("TIMST_BALCA09", IntegerType(), True), StructField("TIMST_BALCA07", IntegerType(), True), StructField("TIMST_BALCA05", IntegerType(), True), StructField("TIMST_BALCA03", IntegerType(), True), StructField("TIMST_BALCA01", IntegerType(), True), StructField("TIMST_BALMAX", IntegerType(), True), StructField("TIMST_BALMEMO", IntegerType(), True), StructField("TIMST_BALCUR", IntegerType(), True), StructField("TIMST_BALAV11", IntegerType(), True), StructField("TIMST_BALAV09", IntegerType(), True), StructField("TIMST_BALAV07", IntegerType(), True), StructField("TIMST_BALAV05", IntegerType(), True), StructField("TIMST_BALAV03", IntegerType(), True), StructField("TIMST_BALAV01", IntegerType(), True), StructField("TIMST_ISSVALUE", IntegerType(), True), StructField("TIMST_ISSDATE", IntegerType(), True), StructField("TIMST_IFUSE", StringType(), True), StructField("TIMST_IFMOD", StringType(), True), StructField("TIMST_IFC2BRK", IntegerType(), True), StructField("TIMST_IFC1BRK", IntegerType(), True), StructField("TIMST_UPD_ORG", StringType(), True), StructField("TIMST_UPD_TIME", IntegerType(), True), StructField("TIMST_ACCOUNT", IntegerType(), True), StructField("DATE", StringType(), True), StructField("DATA_DATE", StringType(), True), StructField("RptRecInd", StringType(), True), StructField("TIMST_INST", IntegerType(), True), StructField("TIMST_UPD_DATE", IntegerType(), True), StructField("TIMST_UPD_USER", StringType(), True), StructField("TIMST_IFC1NA", StringType(), True), StructField("TIMST_IFC2NA", StringType(), True), StructField("TIMST_IFCODE", StringType(), True), StructField("TIMST_IFALT", StringType(), True), StructField("TIMST_IFSHORT", StringType(), True), StructField("TIMST_ISSPOST", IntegerType(), True), StructField("TIMST_BALAGR", IntegerType(), True), StructField("TIMST_BALAV02", IntegerType(), True), StructField("TIMST_BALAV04", IntegerType(), True), StructField("TIMST_BALAV06", IntegerType(), True), StructField("TIMST_BALAV08", IntegerType(), True), StructField("TIMST_BALAV10", IntegerType(), True), StructField("TIMST_BALAV12", IntegerType(), True), StructField("TIMST_OLCREDITS", IntegerType(), True), StructField("TIMST_BALLRG", IntegerType(), True), StructField("TIMST_BALCAGR", IntegerType(), True), StructField("TIMST_BALCA02", IntegerType(), True), StructField("TIMST_BALCA04", IntegerType(), True), StructField("TIMST_BALCA06", IntegerType(), True), StructField("TIMST_BALCA08", IntegerType(), True), StructField("TIMST_BALCA10", IntegerType(), True), StructField("TIMST_BALCA12", IntegerType(), True), StructField("TIMST_ODCOUNT", IntegerType(), True), StructField("TIMST_ODY02", IntegerType(), True), StructField("TIMST_ODY04", IntegerType(), True), StructField("TIMST_ODY06", IntegerType(), True), StructField("TIMST_ODY08", IntegerType(), True), StructField("TIMST_ODY10", IntegerType(), True), StructField("TIMST_ODY12", IntegerType(), True), StructField("TIMST_PBNBKDRAMT", IntegerType(), True), StructField("TIMST_PBNBKNBR", IntegerType(), True), StructField("TIMST_PBBALDL", IntegerType(), True), StructField("TIMST_PBDISCP", StringType(), True), StructField("TIMST_STMCRAMT", IntegerType(), True), StructField("TIMST_STMRATES", StringType(), True), StructField("TIMST_STMTYPE", StringType(), True), StructField("TIMST_STMCODLS", IntegerType(), True), StructField("TIMST_STMCOFREQ", StringType(), True), StructField("TIMST_STMCODAY1", IntegerType(), True), StructField("TIMST_STMCODAY3", IntegerType(), True), StructField("TIMST_STMCONSD", IntegerType(), True), StructField("TIMST_STMAGR", IntegerType(), True), StructField("TIMST_SCDTLST", IntegerType(), True), StructField("TIMST_SCFREQ", StringType(), True), StructField("TIMST_SCDAY1", IntegerType(), True), StructField("TIMST_SCDAY3", IntegerType(), True), StructField("TIMST_SCHAM01", IntegerType(), True), StructField("TIMST_SCHAM02", IntegerType(), True), StructField("TIMST_SCHAM03", IntegerType(), True), StructField("TIMST_SCHAM04", IntegerType(), True), StructField("TIMST_SCHAM05", IntegerType(), True), StructField("TIMST_SCHAM06", IntegerType(), True), StructField("TIMST_SCHAM07", IntegerType(), True), StructField("TIMST_SCHAM08", IntegerType(), True), StructField("TIMST_SCHAM09", IntegerType(), True), StructField("TIMST_SCHAM10", IntegerType(), True), StructField("TIMST_SCHAM11", IntegerType(), True), StructField("TIMST_SCHAM12", IntegerType(), True), StructField("TIMST_SCCODE", StringType(), True), StructField("TIMST_SCACCT", IntegerType(), True), StructField("TIMST_SCDRNBR", IntegerType(), True), StructField("TIMST_SCCHECKS", IntegerType(), True), StructField("TIMST_SCLOWBAL", IntegerType(), True), StructField("TIMST_SCAGRBAL", IntegerType(), True), StructField("TIMST_MATFINAL", IntegerType(), True), StructField("TIMST_MATDISPCODE", StringType(), True), StructField("TIMST_MATURED", StringType(), True), StructField("TIMST_MATAPPL", IntegerType(), True), StructField("TIMST_RENFIRST", IntegerType(), True), StructField("TIMST_RENOPTN", StringType(), True), StructField("TIMST_RENTERM", IntegerType(), True), StructField("TIMST_PRRENNOTLDT", IntegerType(), True), StructField("TIMST_RENCOBAL", IntegerType(), True), StructField("TIMST_RENRATEAGR", IntegerType(), True), StructField("TIMST_RENBALCD", StringType(), True), StructField("TIMST_RENEFFDT", IntegerType(), True), StructField("TIMST_RENINTFREQ", StringType(), True), StructField("TIMST_RENINTDAY", IntegerType(), True), StructField("TIMST_GRACEFLAG", StringType(), True), StructField("TIMST_GRACEENDDT", IntegerType(), True), StructField("TIMST_OID1PAID", IntegerType(), True), StructField("TIMST_OID1MOAMT", IntegerType(), True), StructField("TIMST_OID2RPTD", IntegerType(), True), StructField("TIMST_OID2BEGDT", IntegerType(), True), StructField("TIMST_INTNXT", IntegerType(), True), StructField("TIMST_INTTERM", IntegerType(), True), StructField("TIMST_INTDISP", StringType(), True), StructField("TIMST_INTPDDT", IntegerType(), True), StructField("TIMST_INTCODE", StringType(), True), StructField("TIMST_INTRATECD", StringType(), True), StructField("TIMST_INTMAXRATE", IntegerType(), True), StructField("TIMST_INTMETH", StringType(), True), StructField("TIMST_INTYEAR", StringType(), True), StructField("TIMST_INTDATE", IntegerType(), True), StructField("TIMST_INT1099", IntegerType(), True), StructField("TIMST_INTPEN1099", IntegerType(), True), StructField("TIMST_INTAVAIL", IntegerType(), True), StructField("TIMST_INTEQUAMT", IntegerType(), True), StructField("TIMST_INTACCT", IntegerType(), True), StructField("TIMST_INTRATE1", IntegerType(), True), StructField("TIMST_INTDTCHG", IntegerType(), True), StructField("TIMST_INTCMPTERM", IntegerType(), True), StructField("TIMST_INTCMPDATE", IntegerType(), True), StructField("TIMST_INTCOBAL", IntegerType(), True), StructField("TIMST_INTRATECHG", IntegerType(), True), StructField("TIMST_INTDIFF", IntegerType(), True), StructField("TIMST_INTPRIMINDR", IntegerType(), True), StructField("TIMST_INTPDLTD", IntegerType(), True), StructField("TIMST_IRACODE", StringType(), True), StructField("TIMST_SPOUSAL", IntegerType(), True), StructField("TIMST_MCERTNR", StringType(), True), StructField("TIMST_MSTATUS", StringType(), True), StructField("TIMST_MNOPOST", StringType(), True), StructField("TIMST_MSAFEKP", StringType(), True), StructField("TIMST_MPUBLIC", StringType(), True), StructField("TIMST_MNEGOT", StringType(), True), StructField("TIMST_MSECURED", StringType(), True), StructField("TIMST_MSPEC2", StringType(), True), StructField("TIMST_MSPEC4", StringType(), True), StructField("TIMST_MSPEC6", StringType(), True), StructField("TIMST_MDORMDT", IntegerType(), True), StructField("TIMST_MMNTDT", IntegerType(), True), StructField("TIMST_MREISSUE", StringType(), True), StructField("TIMST_MNEWACCT", IntegerType(), True), StructField("TIMST_MFCREQ", StringType(), True), StructField("TIMST_MDATAREQ", StringType(), True), StructField("TIMST_MBKENTRYCD", StringType(), True), StructField("TIMST_MFLAG2", StringType(), True), StructField("TIMST_MFLAG4", StringType(), True), StructField("TIMST_MFLAG6", StringType(), True), StructField("TIMST_MFLAG8", StringType(), True), StructField("TIMST_MBRANCH", IntegerType(), True), StructField("TIMST_MTYPE", IntegerType(), True), StructField("TIMST_MOFFICER", StringType(), True), StructField("TIMST_MDEPDT", IntegerType(), True), StructField("TIMST_MWDDT", IntegerType(), True), StructField("TIMST_MSIC", IntegerType(), True), StructField("TIMST_MACCTNG", IntegerType(), True), StructField("TIMST_MRECON", StringType(), True), StructField("TIMST_MSOCSEC", IntegerType(), True), StructField("TIMST_MFCAMT2", IntegerType(), True), StructField("TIMST_MFCAMT4", IntegerType(), True), StructField("TIMST_MFCAMT6", IntegerType(), True), StructField("TIMST_MFCAMT8", IntegerType(), True), StructField("TIMST_MFBAMT1", IntegerType(), True), StructField("TIMST_MFBAMT3", IntegerType(), True), StructField("TIMST_MFBAMT5", IntegerType(), True), StructField("TIMST_MFBAMT7", IntegerType(), True), StructField("TIMST_MFBAMT9", IntegerType(), True), StructField("TIMST_MPENRTN", IntegerType(), True), StructField("TIMST_RATETERM", IntegerType(), True), StructField("TIMST_RATENEXT", IntegerType(), True), StructField("TIMST_FEDTAXYTD", IntegerType(), True), StructField("TIMST_FEDTAXLAST", IntegerType(), True), StructField("TIMST_FEDEXPDT", IntegerType(), True), StructField("TIMST_FEDSTCHGDT", IntegerType(), True), StructField("TIMST_MSOCSECREQ2", IntegerType(), True), StructField("TIMST_PNTINTH", StringType(), True), StructField("TIMST_PNTAVAL", StringType(), True), StructField("TIMST_PNTASGN", StringType(), True), StructField("TIMST_PNTMISC3", StringType(), True), StructField("TIMST_PNTMISC1", StringType(), True), StructField("TIMST_NOTCPREREN", StringType(), True), StructField("TIMST_NOTCMAT", StringType(), True), StructField("TIMST_RASSGN", StringType(), True), StructField("TIMST_STMCMBMNT", StringType(), True), StructField("TIMST_RCLSVAL", IntegerType(), True), StructField("TIMST_RCKSOUT", IntegerType(), True), StructField("TIMST_CUSTPAYDT", IntegerType(), True), StructField("TIMST_CUSTSVCDT", IntegerType(), True), StructField("TIMST_TDOASEQ", StringType(), True), StructField("TIMST_TDOARATECD", StringType(), True), StructField("TIMST_USERAREA", StringType(), True), StructField("TIMST_RSVDATE1", IntegerType(), True), StructField("TIMST_RSVDATE3", IntegerType(), True), StructField("TIMST_RSVNBR1", IntegerType(), True), StructField("TIMST_STMENP", IntegerType(), True), StructField("TIMST_RSVNBR5", IntegerType(), True), StructField("TIMST_MREGDD", StringType(), True), StructField("TIMST_MNEWCOSTC", IntegerType(), True), StructField("TIMST_REORGBAL", IntegerType(), True), StructField("TIMST_SOURCEFUND", StringType(), True), StructField("TIMST_ALERT2", StringType(), True), StructField("TIMST_ALERT4", StringType(), True), StructField("TIMST_ALERT6", StringType(), True), StructField("TIMST_RENRENFREQ", StringType(), True), StructField("TIMST_RENRENDAY", IntegerType(), True), StructField("TIMST_RENINTACCT", IntegerType(), True), StructField("TIMST_OFFICER2DES", StringType(), True), StructField("TIMST_RSVNBR3", StringType(), True)
        ])
        )\
        .option("header", True)\
        .option("quote", "000")\
        .option("sep", "\u00FD")\
        .csv(f"{Config.SOURCE_DIR}/timeV8.3.1/time_tismst_{Config.BANK_NUM}_{Config.DATA_DATE}.253")
