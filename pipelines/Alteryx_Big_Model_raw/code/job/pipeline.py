from pyspark.sql import *
from pyspark.sql.functions import *
from pyspark.sql.types import *
from job.config.ConfigStore import *
from job.udfs.UDFs import *
from prophecy.utils import *
from job.graph import *

def pipeline(spark: SparkSession) -> None:
    df_DSN_r2s_prod_edw_alt = DSN_r2s_prod_edw_alt(spark)
    df_AlteryxSelect_296 = AlteryxSelect_296(spark, df_DSN_r2s_prod_edw_alt)
    df_AlteryxSelect_205 = AlteryxSelect_205(spark, df_AlteryxSelect_296)
    df_aka_miscsql_Query_se = aka_miscsql_Query_se(spark)
    df_DSN_r2s_prod_edw_alt_301 = DSN_r2s_prod_edw_alt_301(spark)
    df_salessampleorder = salessampleorder(spark, df_DSN_r2s_prod_edw_alt_301)
    df_AlteryxSelect_302 = AlteryxSelect_302(spark, df_salessampleorder)
    df_AlteryxSelect_300 = AlteryxSelect_300(spark, df_AlteryxSelect_302)
    df_DSN_r2s_prod_edw_alt_298 = DSN_r2s_prod_edw_alt_298(spark)
    df_AlteryxSelect_299 = AlteryxSelect_299(spark, df_DSN_r2s_prod_edw_alt_298)
    df_AlteryxSelect_171 = AlteryxSelect_171(spark, df_AlteryxSelect_299)
    df_aka_miscsql_Query_se_168 = aka_miscsql_Query_se_168(spark)
    df_Filter_177 = Filter_177(spark, df_aka_miscsql_Query_se_168)
    df_Join_178_inner = Join_178_inner(spark, df_Filter_177, df_aka_miscsql_Query_se)
    df_Join_179_inner = Join_179_inner(spark, df_Join_178_inner, df_AlteryxSelect_171)
    df_Join_173_inner = Join_173_inner(spark, df_Join_179_inner, df_aka_miscsql_Query_se_168)
    df_Join_174_inner = Join_174_inner(spark, df_Join_173_inner, df_aka_miscsql_Query_se)
    df_Join_175_inner = Join_175_inner(spark, df_Join_174_inner, df_AlteryxSelect_171)
    df_aka_bisql_Query_sele = aka_bisql_Query_sele(spark)
    df_AlteryxSelect_189 = AlteryxSelect_189(spark, df_aka_bisql_Query_sele)
    df_aka_bisql_Query_sele_183 = aka_bisql_Query_sele_183(spark)
    df_AlteryxSelect_184 = AlteryxSelect_184(spark, df_aka_bisql_Query_sele_183)
    df_aka_bisql_Query_sele_185 = aka_bisql_Query_sele_185(spark)
    df_AlteryxSelect_186 = AlteryxSelect_186(spark, df_aka_bisql_Query_sele_185)
    df_Join_187_inner = Join_187_inner(spark, df_AlteryxSelect_184, df_AlteryxSelect_186)
    df_Join_190_inner = Join_190_inner(spark, df_Join_187_inner, df_AlteryxSelect_189)
    df_Join_191_left_UnionLeftOuter = Join_191_left_UnionLeftOuter(spark, df_Join_175_inner, df_Join_190_inner)
    df_Join_164_inner = Join_164_inner(spark, df_Join_191_left_UnionLeftOuter, df_AlteryxSelect_171)
    df_Unique_165 = Unique_165(spark, df_Join_164_inner)
    df_AlteryxSelect_166 = AlteryxSelect_166(spark, df_Unique_165)
    df_AlteryxSelect_293 = AlteryxSelect_293(spark, df_AlteryxSelect_299)
    df_Part = Part(spark, df_AlteryxSelect_293)
    df_PartSeriesPlusOption = PartSeriesPlusOption(spark)
    df_AlteryxSelect_279 = AlteryxSelect_279(spark, df_PartSeriesPlusOption)
    df_Join_280_left_UnionLeftOuter = Join_280_left_UnionLeftOuter(spark, df_Part, df_AlteryxSelect_279)
    df_yxmc_284 = yxmc_284(spark, df_Join_280_left_UnionLeftOuter)
    df_LikePart = LikePart(spark, df_yxmc_284)
    df_ManufacturingOrder_y = ManufacturingOrder_y(spark)
    df_AlteryxSelect_200 = AlteryxSelect_200(spark, df_ManufacturingOrder_y)
    df_Daterangeandnotdeleted = Daterangeandnotdeleted(spark, df_AlteryxSelect_200)
    df_ProcessOrderTransact = ProcessOrderTransact(spark)
    df_Summarize_208 = Summarize_208(spark, df_ProcessOrderTransact)
    df_Formula_213 = Formula_213(spark, df_Summarize_208)
    df_ProcessOrder_yxdb = ProcessOrder_yxdb(spark)
    df_AlteryxSelect_201 = AlteryxSelect_201(spark, df_ProcessOrder_yxdb)
    df_Filter_207 = Filter_207(spark, df_AlteryxSelect_201)
    df_DSN_r2s_prod_edw_alt_297 = DSN_r2s_prod_edw_alt_297(spark)
    df_ExcludeTransferandPS_left = ExcludeTransferandPS_left(spark, df_AlteryxSelect_205, df_DSN_r2s_prod_edw_alt_297)
    df_Join_212_inner = Join_212_inner(spark, df_Filter_207, df_ExcludeTransferandPS_left)
    df_MaxStepWC = MaxStepWC(spark, df_Join_212_inner)
    df_MaxStepOrder = MaxStepOrder(spark, df_Join_212_inner)
    df_Join_216_inner = Join_216_inner(spark, df_Join_212_inner, df_MaxStepOrder)
    df_Join_217_inner = Join_217_inner(spark, df_Join_216_inner, df_MaxStepWC)
    df_Formula_218 = Formula_218(spark, df_Join_217_inner)
    df_Join_219_left_UnionLeftOuter = Join_219_left_UnionLeftOuter(spark, df_Formula_218, df_Formula_213)
    df_Formula_220 = Formula_220(spark, df_Join_219_left_UnionLeftOuter)
    df_Join_221_inner = Join_221_inner(spark, df_Daterangeandnotdeleted, df_Formula_220)
    df_Formula_222 = Formula_222(spark, df_Join_221_inner)
    df_Join_224_inner = Join_224_inner(spark, df_Formula_222, df_LikePart)
    df_Formula_227 = Formula_227(spark, df_Join_224_inner)
    df_AlteryxSelect_223 = AlteryxSelect_223(spark, df_Formula_227)
    df_AlteryxSelect_230 = AlteryxSelect_230(spark, df_AlteryxSelect_223)
    df_Join_242_left = Join_242_left(spark, df_AlteryxSelect_166, df_AlteryxSelect_230)
    df_AlteryxSelect_255 = AlteryxSelect_255(spark, df_Join_242_left)
    df_Union_245_reformat_0 = Union_245_reformat_0(spark, df_AlteryxSelect_255)
    df_Join_242_inner = Join_242_inner(spark, df_AlteryxSelect_166, df_AlteryxSelect_230)
    df_AlteryxSelect_256 = AlteryxSelect_256(spark, df_Join_242_inner)
    df_Union_245_reformat_1 = Union_245_reformat_1(spark, df_AlteryxSelect_256)
    df_Join_242_right = Join_242_right(spark, df_AlteryxSelect_230, df_AlteryxSelect_166)
    df_AlteryxSelect_257 = AlteryxSelect_257(spark, df_Join_242_right)
    df_Union_245_reformat_2 = Union_245_reformat_2(spark, df_AlteryxSelect_257)
    df_Union_245 = Union_245(spark, df_Union_245_reformat_0, df_Union_245_reformat_1, df_Union_245_reformat_2)
    df_aka_bisql_Query_sele_158 = aka_bisql_Query_sele_158(spark)
    df_AlteryxSelect_159 = AlteryxSelect_159(spark, df_aka_bisql_Query_sele_158)
    df_AlteryxSelect_156 = AlteryxSelect_156(spark, df_aka_bisql_Query_sele_183)
    df_aka_bisql_Query_sele_154 = aka_bisql_Query_sele_154(spark)
    df_AlteryxSelect_157 = AlteryxSelect_157(spark, df_aka_bisql_Query_sele_154)
    df_Join_155_left_UnionLeftOuter = Join_155_left_UnionLeftOuter(spark, df_AlteryxSelect_156, df_AlteryxSelect_157)
    df_Join_160_left_UnionLeftOuter = Join_160_left_UnionLeftOuter(
        spark, 
        df_Join_155_left_UnionLeftOuter, 
        df_AlteryxSelect_159
    )
    df_Join_246_left = Join_246_left(spark, df_Union_245, df_Join_160_left_UnionLeftOuter)
    df_AlteryxSelect_258 = AlteryxSelect_258(spark, df_Join_246_left)
    df_Union_247_reformat_0 = Union_247_reformat_0(spark, df_AlteryxSelect_258)
    df_Join_246_inner = Join_246_inner(spark, df_Union_245, df_Join_160_left_UnionLeftOuter)
    df_AlteryxSelect_259 = AlteryxSelect_259(spark, df_Join_246_inner)
    df_Union_247_reformat_1 = Union_247_reformat_1(spark, df_AlteryxSelect_259)
    df_Join_246_right = Join_246_right(spark, df_Join_160_left_UnionLeftOuter, df_Union_245)
    df_AlteryxSelect_260 = AlteryxSelect_260(spark, df_Join_246_right)
    df_Union_247_reformat_2 = Union_247_reformat_2(spark, df_AlteryxSelect_260)
    df_Union_247 = Union_247(spark, df_Union_247_reformat_0, df_Union_247_reformat_1, df_Union_247_reformat_2)
    df_AlteryxSelect_254 = AlteryxSelect_254(spark, df_Union_247)
    df_Formula_249 = Formula_249(spark, df_AlteryxSelect_254)
    df_Filter_248 = Filter_248(spark, df_Formula_249)
    df_aka_bisql_Query_sele_232 = aka_bisql_Query_sele_232(spark)
    df_DateRange = DateRange(spark, df_aka_bisql_Query_sele_232)
    df_AlteryxSelect_235 = AlteryxSelect_235(spark, df_aka_bisql_Query_sele)
    df_AppendFields_234 = AppendFields_234(spark, df_DateRange, df_AlteryxSelect_235)
    df_AlteryxSelect_236 = AlteryxSelect_236(spark, df_AlteryxSelect_296)
    df_Unique_237 = Unique_237(spark, df_AlteryxSelect_236)
    df_AppendFields_238 = AppendFields_238(spark, df_AppendFields_234, df_Unique_237)
    df_Join_243_left = Join_243_left(spark, df_Filter_248, df_AppendFields_238)
    df_AlteryxSelect_261 = AlteryxSelect_261(spark, df_Join_243_left)
    df_Union_244_reformat_0 = Union_244_reformat_0(spark, df_AlteryxSelect_261)
    df_Join_243_inner = Join_243_inner(spark, df_Filter_248, df_AppendFields_238)
    df_AlteryxSelect_262 = AlteryxSelect_262(spark, df_Join_243_inner)
    df_Union_244_reformat_1 = Union_244_reformat_1(spark, df_AlteryxSelect_262)
    df_Join_243_right = Join_243_right(spark, df_AppendFields_238, df_Filter_248)
    df_AlteryxSelect_263 = AlteryxSelect_263(spark, df_Join_243_right)
    df_Union_244_reformat_2 = Union_244_reformat_2(spark, df_AlteryxSelect_263)
    df_Union_244 = Union_244(spark, df_Union_244_reformat_0, df_Union_244_reformat_1, df_Union_244_reformat_2)
    df_Unique_252 = Unique_252(spark, df_Union_244)
    df_AlteryxSelect_250 = AlteryxSelect_250(spark, df_Unique_252)
    df_Join_251_inner = Join_251_inner(spark, df_AlteryxSelect_250, df_AlteryxSelect_300)
    df_AlteryxSelect_253 = AlteryxSelect_253(spark, df_Join_251_inner)
    df_Formula_265 = Formula_265(spark, df_AlteryxSelect_253)
    df_AlteryxSelect_264 = AlteryxSelect_264(spark, df_Formula_265)
    df_DynamicRename_282 = DynamicRename_282(spark, df_AlteryxSelect_264)
    df_AlteryxSelect_286 = AlteryxSelect_286(spark, df_DynamicRename_282)
    df_AlteryxSelect_304 = AlteryxSelect_304(spark, df_AlteryxSelect_286)
    df_Formula_305 = Formula_305(spark, df_AlteryxSelect_304)
    DSN_r2s_prod_aa_alte(spark, df_Formula_305)
    DSN_edw_Query_manufa(spark, df_Formula_305)
    df_ExcludeTransferandPS_inner = ExcludeTransferandPS_inner(spark, df_AlteryxSelect_205, df_DSN_r2s_prod_edw_alt_297)
    MachineCapacity_yxdb(spark, df_AlteryxSelect_286)

def main():
    spark = SparkSession.builder\
                .config("spark.default.parallelism", "4")\
                .config("spark.sql.legacy.allowUntypedScalaUDF", "true")\
                .enableHiveSupport()\
                .appName("Prophecy Pipeline")\
                .getOrCreate()
    Utils.initializeFromArgs(spark, parse_args())
    spark.conf.set("prophecy.metadata.pipeline.uri", "pipelines/Alteryx_Big_Model_raw")
    registerUDFs(spark)
    
    MetricsCollector.instrument(spark = spark, pipelineId = "pipelines/Alteryx_Big_Model_raw", config = Config)(pipeline)

if __name__ == "__main__":
    main()
